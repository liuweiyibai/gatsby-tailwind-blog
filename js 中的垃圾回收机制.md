---
title: js 中的垃圾回收机制
date: 2021-05-07 14:07:45
category:
  - 编程笔记
tags: ['js']
slug: the-garbage-collection-mechanism-in-the-js
thumbnail: ''
---

JavaScript 中内存管理的主要概念是可达性。当一个变量被外界的引用为 0 时，将会被回收。

基本的垃圾回收算法称为 “标记-清除” ，定期执行标记根，标记引用，没有被引用的变量将被回收

垃圾回收是自动完成的，我们不能强制执行或是阻止执行。当对象是可达状态时，它一定是存在于内存中的。被引用与可访问（从一个根）不同：一组相互连接的对象可能整体都不可达。

## 变量的生命周期

当一个变量的生命周期结束之后它所指向的内存就应该被释放。JS 有两种变量，全局变量和在函数中产生的局部变量。局部变量的生命周期在函数执行过后就结束了，此时便可将它引用的内存释放（即垃圾回收），但全局变量生命周期会持续到浏览器关闭页面。

## 垃圾回收方法

1. 标记清除
   垃圾收集器在运行的时候会给存储在内存中的所有变量都加上标记，去掉已经被标记为引用的的变量，在此之后再被标记的变量将被视为准备删除的变量。最后垃圾回收器清除标记的变量，回收它们所占用的内存空间
   目前主流浏览器都是使用标记清除式的垃圾回收策略，只不过收集的间隔有所不同

   未被引用的变量包括不可达变量，声明未使用的变量

2. 引用计数

   跟踪记录每个值被引用的次数，当某个变量的引用次数为 0 的时候，该变量就被下一次辣鸡回收所回收

## 参考地址

[前端面试：谈谈 JS 垃圾回收机制](https://segmentfault.com/a/1190000018605776)

[JavaScript 垃圾回收机制](https://zhuanlan.zhihu.com/p/60336501)

[javascript 垃圾回收机制 - 标记清除法/引用计数/V8 机制](https://segmentfault.com/a/1190000019276047)

[JavaScript 中的垃圾回收和内存泄漏](https://blog.fundebug.com/2019/04/30/javascript-memory-management/)
