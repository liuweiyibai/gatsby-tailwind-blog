---
title: html 模板引擎
tags:
  - html
  - js
category:
  - 编程笔记
date: 2017-07-18 18:00:28
slug: html-template-engine
thumbnail: '../../thumbnails/tag.png'
---

什么是 `artTemplate`，是一个性能卓越的 `js` 模板引擎

`artTemplate` 的库分为两种，一个是 `template.js` ，一个是 `template-native.js` ， 第一个是简洁语法版，第二个是原生语法（感觉像 `JSP` ）版，两个库的语法是不一样的，大家不要混用，否则会报错的。

`template-native.js`-> 原生 js 语法
`template.js` -> 支持语法不一样 模板引擎 `artTemplate mustache` 语法

1. 安装

   ```bash
   # 安装
   bower install artTemplate --save
   npm install artTemplate --save
   ```

2. 具体使用：原生语法版

   ```html
   <script src="template.js"></script>
   <!-- 定义模板内容 -->
   <script type="text/html" id="tpl">
     <h1>{{title}}</h1>
     <strong>{{arr.length}}</strong>
     <ul>
       {{each arr as value i}}
       <li>索引 {{i + 1}} ：{{value}}</li>
       {{/each}}
     </ul>
   </script>
   <script>
     var data = {
       title: 'welcome ArtTemplate',
       arr: ['apple', 'banana', 'orange', 'pear']
     }
     window.onload = function () {
       var oBox = document.querySelector('#box')
       var sHTML = template('tpl', data)
       oBox.innerHTML = sHTML
     }
   </script>
   <div id="box"></div>
   // 模板盛放标签
   ```

3. 简洁语法介绍，循环的使用

   ```html
   <!-- 放置模板的地方 -->
   <div id="box"></div>

   {{each arr as value key}} // arr是一个数组
   <script src="template.js"></script>
   <script type="text/html" id="tpl">
     <ul>
       {{each json as value key}}
       <li>{{value}} ----> {{key}}</li>
       {{/each}}
     </ul>
   </script>
   <script>
     var data = {
       json: {
         a: 'apple',
         b: 'banana',
         c: 'orange',
         d: 'pear'
       }
     }
     window.onload = function () {
       oBox = document.getElementById('box')
       sHTML = template('tpl', data)
       x.innerHTML = sHTML
     }
   </script>
   ```

- 自定义模板标记

  ```html
  <script src="template-native.js"></script>
  <script type="text/html" id="tpl">
      <div>{$=msg$}</div>
      <div>{$=#msg2$}</div>
  </script>
  <script>
    template.config('openTag','{$'); // 设置开头标签
    template.config('closeTag','$}'); // 设置结尾标签
    template.config('escape',false); // 非转意输出
    var data = {
      msg:'abcdef',
      msg2:'<strong>加粗了</strong>'
    };
    window.onload = function(){
      var oBox = document.getElementById('box');
      var sHTML = template('tpl',data);
      oBox.innerHTML=sHTML;
    };
  </script>
  </head>
  <body>
    <div id="box"></div>
  </body>
  ```

## 模板引擎原理

模板的诞生就是为了将数据和显示分离，模板的技术有很多种类，但是本质都是将模板文件和数据通过模板引擎的解析最终生成 HTML 代码。实现方法是利用正则表达式识别模板标识，并且利用数据替换标识中的标识符

- 实现一个简单的模板引擎

  ```js
  var name = 'world'
  hello <%= name %>
  // 字符串替换思想
  function temp (str,obj){
    if(typeof str === 'string'){
      return str.replace(/<%=\s*([^%>]+)\s*%>/g),function(){
        var key = argument[1];
        return obj[key]
      }
    }
  }
  ```
