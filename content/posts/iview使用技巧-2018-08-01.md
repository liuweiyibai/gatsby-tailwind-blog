---
title: iview 使用技巧
tags:
  - vue
  - iview
category:
  - 编程笔记
slug: generate-iview-table-into-html-table-format
date: 2018-08-01 14:18:16
thumbnail: '../thumbnails/iviewlogo.png'
---

## 将 iview 表格生成 html table 格式

将 iview 表格生成 html table 格式，然后配合 `xlsx.js` 导出 `excel` 表格

## 代码

```js
const buildTable = (theadData, tbodyEle) => {
  // 写入key过滤不显示的td
  let thArr = [];
  // 建立节点
  let table = document.createElement('table');
  let thead = document.createElement('thead');
  let tbody = tbodyEle.$el
    .getElementsByClassName('ivu-table-tbody')[0]
    .cloneNode(true);

  //  建立thead中的tr
  let thTr = document.createElement('tr');
  //  遍历写入th表头
  for (let i of theadData) {
    thArr.push(i.key);
    let th = document.createElement('th');
    let text = document.createTextNode(i.title);
    th.appendChild(text);
    thTr.appendChild(th);
  }

  thead.appendChild(thTr);
  table.appendChild(thead);
  table.appendChild(tbody);
  return table;
};
```
